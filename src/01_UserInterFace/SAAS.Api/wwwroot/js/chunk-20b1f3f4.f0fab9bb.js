(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20b1f3f4"],{7869:function(e,t,r){},"838a":function(e,t,r){"use strict";r.d(t,"f",(function(){return s})),r.d(t,"c",(function(){return i})),r.d(t,"g",(function(){return o})),r.d(t,"e",(function(){return a})),r.d(t,"d",(function(){return l})),r.d(t,"b",(function(){return c})),r.d(t,"h",(function(){return u})),r.d(t,"i",(function(){return d})),r.d(t,"a",(function(){return p}));var n=r("66df"),s=function(e){return n["a"].request({url:"rbac/role/rolelist",method:"post",data:e})},i=function(e){return n["a"].request({url:"rbac/role/createrole",method:"post",data:e})},o=function(e){return n["a"].request({url:"rbac/role/editrole/"+e.id,method:"get"})},a=function(e){return n["a"].request({url:"rbac/role/updaterole",method:"post",data:e})},l=function(e){return n["a"].request({url:"rbac/role/deleterole/"+e,method:"get"})},c=function(e){return n["a"].request({url:"rbac/role/batchrole",method:"post",data:e})},u=function(e){return n["a"].request({url:"rbac/role/findlistbyuserid/"+e,method:"get"})},d=function(){return n["a"].request({url:"rbac/role/findsimplelist",method:"get"})},p=function(e){return n["a"].request({url:"rbac/role/assignpermission",method:"post",data:e})}},a8ba:function(e,t,r){"use strict";r.d(t,"e",(function(){return s})),r.d(t,"b",(function(){return i})),r.d(t,"f",(function(){return o})),r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return l})),r.d(t,"a",(function(){return c})),r.d(t,"g",(function(){return u}));var n=r("66df"),s=function(e){return n["a"].request({url:"rbac/permission/permissionlist",method:"post",data:e})},i=function(e){return n["a"].request({url:"rbac/permission/createpermission",method:"post",data:e})},o=function(e){return n["a"].request({url:"rbac/permission/editpermission/"+e.id,method:"get"})},a=function(e){return n["a"].request({url:"rbac/permission/updatepermission",method:"post",data:e})},l=function(e){return n["a"].request({url:"rbac/permission/deletepermission/"+e,method:"get"})},c=function(e){return n["a"].request({url:"rbac/permission/batchpermission",method:"post",data:e})},u=function(e){return n["a"].request({url:"rbac/permission/permissiontree/"+e,method:"get"})}},d7a6:function(e,t,r){"use strict";var n=r("7869"),s=r.n(n);s.a},df67:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Card",[r("Row",{attrs:{gutter:15}},[r("Col",{attrs:{span:"4"}},[r("h3",{staticStyle:{"background-color":"#f3f3f3","margin-bottom":"0",padding:"5px 5px 5px 10px",position:"relative"}},[e._v("角色列表\n          "),r("span",{staticStyle:{display:"inline-block",position:"absolute",right:"6px",top:"4px"}},[r("Tooltip",{attrs:{content:"刷新角色列表"}},[r("Button",{attrs:{shape:"circle",size:"small",icon:"md-refresh"},on:{click:e.handleReloadRoleListClick}})],1)],1)]),r("ul",{staticClass:"role-list-box"},e._l(e.stores.role.data,(function(t){return r("li",{class:{active:t.selected},on:{click:function(r){return e.handleRoleClicked(t)}}},[e._v(e._s(t.name))])})),0)]),r("Col",{attrs:{span:"20"}},[r("div",{staticStyle:{"margin-bottom":"10px"}},[r("h3",{staticStyle:{"background-color":"#f3f3f3","margin-bottom":"0",padding:"5px 5px 5px 10px"}},[e._v("权限列表")]),r("span",{staticStyle:{display:"inline-block",position:"absolute",right:"0",top:"1px"}},[r("Button",{attrs:{icon:"md-checkmark-circle",type:"primary"},on:{click:e.handleSaveRolePermissions}},[e._v("保 存")])],1)]),r("Tree",{staticClass:"permission-tree-box",attrs:{data:e.stores.permissionTree.data,render:e.renderContent}})],1)],1)],1)],1)},s=[],i=(r("cc57"),r("838a")),o=r("a8ba"),a={name:"rbac_role_permission_page",data:function(){return{selectedPermissions:[],currentRoleCode:"",stores:{role:{data:[]},permissionTree:{data:[]}},buttonProps:{type:"default",size:"small"}}},mounted:function(){this.loadRoles()},methods:{loadRoles:function(){var e=this;Object(i["i"])().then((function(t){for(var r=t.data.data,n=0,s=r.length;n<s;n++)r[n].selected=!1;e.stores.role.data=r}))},loadRolePermissionTree:function(){var e=this;Object(o["g"])(this.currentRoleCode).then((function(t){var r=t.data.data;e.stores.permissionTree.data=r.tree,e.selectedPermissions=r.selectedPermissions}))},handleRoleClicked:function(e){for(var t=0,r=this.stores.role.data.length;t<r;t++)this.stores.role.data[t].selected=!1;this.currentRoleCode=e.id,e.selected=!0,this.loadRolePermissionTree()},handleSaveRolePermissions:function(){var e=this,t={roleId:this.currentRoleCode,permissions:this.selectedPermissions};Object(i["a"])(t).then((function(t){var r=t.data;!0===r.success?e.$Message.success("分配成功"):e.$Message.warning(r.error.errorMessage)}))},handleReloadRoleListClick:function(){this.currentRoleCode="",this.selectedPermissions=[],this.stores.permissionTree.data=[],this.loadRoles()},renderContent:function(e,t){var r=this,n=(t.root,t.node),s=t.data,i=!1;return s.permissions&&s.permissions.length>0&&(i=!0),e("span",{style:{display:"inline-block",width:"100%"},class:"permission-tree-node"},[e("span",[e("Icon",{props:{type:"ios-paper-outline"},style:{marginRight:"5px"}}),e("span",s.title)]),e("span",{style:{display:"inline-block",float:"right",marginRight:"32px"}},[e("div",{style:{display:"inline-block",marginRight:"10px"}},[e("CheckboxGroup",{props:{value:this.selectedPermissions,style:{display:"inline-block"},class:"permission-box"},on:{"on-change":function(e){r.selectedPermissions=e}}},(s.permissions||[]).map((function(t){return e("Checkbox",{props:{label:t.id}},t.name)})))]),e("Checkbox",{props:{label:"全选",value:s.allAssigned},style:{marginLeft:"15px",color:"333",fontWeight:"600",visibility:i?"visible":"hidden"},class:"permission-check-all",on:{"on-change":function(e){r.checkNodePermission(e,s.permissions,n)}}},"全选")])])},checkNodePermission:function(e,t,r){if(r.allAssigned=e,t&&!(t.length<=0))if(e)for(var n=0,s=t.length;n<s;n++){var i=t[n],o=this.selectedPermissions.indexOf(i.id);-1==o&&this.selectedPermissions.push(i.id)}else for(var a=0,l=t.length;a<l;a++){i=t[a],o=this.selectedPermissions.indexOf(i.id);-1!==o&&this.selectedPermissions.splice(o,1)}}}},l=a,c=(r("d7a6"),r("5511")),u=Object(c["a"])(l,n,s,!1,null,null,null);t["default"]=u.exports}}]);